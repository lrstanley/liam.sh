-- Create "github_events" table
CREATE TABLE "github_events" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 4294967296), "event_id" character varying NOT NULL, "event_type" character varying NOT NULL, "created_at" timestamptz NOT NULL, "public" boolean NOT NULL DEFAULT false, "actor_id" bigint NOT NULL, "actor" jsonb NOT NULL, "repo_id" bigint NOT NULL, "repo" jsonb NOT NULL, "payload" jsonb NOT NULL, PRIMARY KEY ("id"));
-- Create index "github_events_event_id_key" to table: "github_events"
CREATE UNIQUE INDEX "github_events_event_id_key" ON "github_events" ("event_id");
-- Create "github_gists" table
CREATE TABLE "github_gists" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 8589934592), "gist_id" character varying NOT NULL, "html_url" character varying NOT NULL, "public" boolean NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "description" character varying NULL, "owner" jsonb NOT NULL, "name" character varying NOT NULL, "type" character varying NOT NULL, "language" character varying NULL, "size" bigint NOT NULL, "raw_url" character varying NOT NULL, "content" character varying NOT NULL, PRIMARY KEY ("id"));
-- Create index "githubgist_gist_id_name" to table: "github_gists"
CREATE UNIQUE INDEX "githubgist_gist_id_name" ON "github_gists" ("gist_id", "name");
-- Create "github_repositories" table
CREATE TABLE "github_repositories" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 17179869184), "repo_id" bigint NOT NULL, "name" character varying NOT NULL, "full_name" character varying NOT NULL, "owner_login" character varying NOT NULL, "owner" jsonb NOT NULL, "public" boolean NOT NULL DEFAULT false, "html_url" character varying NOT NULL, "description" character varying NULL, "fork" boolean NOT NULL DEFAULT false, "homepage" character varying NULL, "star_count" bigint NOT NULL DEFAULT 0, "default_branch" character varying NOT NULL, "is_template" boolean NOT NULL DEFAULT false, "has_issues" boolean NOT NULL DEFAULT true, "archived" boolean NOT NULL DEFAULT false, "pushed_at" timestamptz NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NULL, "license" jsonb NULL, PRIMARY KEY ("id"));
-- Create index "github_repositories_repo_id_key" to table: "github_repositories"
CREATE UNIQUE INDEX "github_repositories_repo_id_key" ON "github_repositories" ("repo_id");
-- Create "ent_types" table
CREATE TABLE "ent_types" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "type" character varying NOT NULL, PRIMARY KEY ("id"));
-- Create index "ent_types_type_key" to table: "ent_types"
CREATE UNIQUE INDEX "ent_types_type_key" ON "ent_types" ("type");
-- Create "github_releases" table
CREATE TABLE "github_releases" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 12884901888), "release_id" bigint NOT NULL, "html_url" character varying NOT NULL, "tag_name" character varying NOT NULL, "target_commitish" character varying NOT NULL, "name" character varying NULL, "draft" boolean NOT NULL, "prerelease" boolean NOT NULL, "created_at" timestamptz NOT NULL, "published_at" timestamptz NOT NULL, "author" jsonb NOT NULL, "github_repository_releases" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "github_releases_github_repositories_releases" FOREIGN KEY ("github_repository_releases") REFERENCES "github_repositories" ("id") ON UPDATE NO ACTION ON DELETE CASCADE);
-- Create index "github_releases_release_id_key" to table: "github_releases"
CREATE UNIQUE INDEX "github_releases_release_id_key" ON "github_releases" ("release_id");
-- Create "github_assets" table
CREATE TABLE "github_assets" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "asset_id" bigint NOT NULL, "browser_download_url" character varying NOT NULL, "name" character varying NOT NULL, "label" character varying NULL, "state" character varying NULL, "content_type" character varying NOT NULL, "size" bigint NOT NULL, "download_count" bigint NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NULL, "uploader" jsonb NOT NULL, "github_release_assets" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "github_assets_github_releases_assets" FOREIGN KEY ("github_release_assets") REFERENCES "github_releases" ("id") ON UPDATE NO ACTION ON DELETE CASCADE);
-- Create index "github_assets_asset_id_key" to table: "github_assets"
CREATE UNIQUE INDEX "github_assets_asset_id_key" ON "github_assets" ("asset_id");
-- Create "users" table
CREATE TABLE "users" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 30064771072), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "user_id" bigint NOT NULL, "login" character varying NOT NULL, "name" character varying NULL, "avatar_url" character varying NULL, "html_url" character varying NULL, "email" character varying NULL, "location" character varying NULL, "bio" character varying NULL, PRIMARY KEY ("id"));
-- Create index "users_login_key" to table: "users"
CREATE UNIQUE INDEX "users_login_key" ON "users" ("login");
-- Create index "users_user_id_key" to table: "users"
CREATE UNIQUE INDEX "users_user_id_key" ON "users" ("user_id");
-- Create "posts" table
CREATE TABLE "posts" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 25769803776), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "slug" character varying NOT NULL, "title" character varying NOT NULL, "content" character varying NOT NULL, "content_html" character varying NOT NULL, "summary" character varying NOT NULL, "published_at" timestamptz NOT NULL, "view_count" bigint NOT NULL DEFAULT 0, "public" boolean NOT NULL DEFAULT false, "user_posts" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "posts_users_posts" FOREIGN KEY ("user_posts") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- Create index "posts_slug_key" to table: "posts"
CREATE UNIQUE INDEX "posts_slug_key" ON "posts" ("slug");
-- Create "labels" table
CREATE TABLE "labels" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 21474836480), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "name" character varying NOT NULL, PRIMARY KEY ("id"));
-- Create index "labels_name_key" to table: "labels"
CREATE UNIQUE INDEX "labels_name_key" ON "labels" ("name");
-- Create "label_posts" table
CREATE TABLE "label_posts" ("label_id" bigint NOT NULL, "post_id" bigint NOT NULL, PRIMARY KEY ("label_id", "post_id"), CONSTRAINT "label_posts_label_id" FOREIGN KEY ("label_id") REFERENCES "labels" ("id") ON UPDATE NO ACTION ON DELETE CASCADE, CONSTRAINT "label_posts_post_id" FOREIGN KEY ("post_id") REFERENCES "posts" ("id") ON UPDATE NO ACTION ON DELETE CASCADE);
-- Create "label_github_repositories" table
CREATE TABLE "label_github_repositories" ("label_id" bigint NOT NULL, "github_repository_id" bigint NOT NULL, PRIMARY KEY ("label_id", "github_repository_id"), CONSTRAINT "label_github_repositories_github_repository_id" FOREIGN KEY ("github_repository_id") REFERENCES "github_repositories" ("id") ON UPDATE NO ACTION ON DELETE CASCADE, CONSTRAINT "label_github_repositories_label_id" FOREIGN KEY ("label_id") REFERENCES "labels" ("id") ON UPDATE NO ACTION ON DELETE CASCADE);
-- Add pk ranges for ('github_assets'),('github_events'),('github_gists'),('github_releases'),('github_repositories'),('labels'),('posts'),('users') tables
INSERT INTO "ent_types" ("type") VALUES ('github_assets'), ('github_events'), ('github_gists'), ('github_releases'), ('github_repositories'), ('labels'), ('posts'), ('users');
